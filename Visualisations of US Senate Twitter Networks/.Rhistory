comparison.cloud(collapsedtweets_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1.6), title.size= 1, max.words = 100, family="Garamond")
comparison.cloud(collapsedtweets_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1.6), title.size= 1, max.words = 100, family="Garamond", fixed.asp=TRUE)
require(magrittr)
require(dplyr)
require(tidyr)
require(lubridate)
require(glue)
require(tibble)
require(tm)
require(wordcloud)
require(ggplot2)
require(ggthemes)
require(ggnetwork)
require(igraph)
require(intergraph)
require(RColorBrewer)
require(extrafont)
loadfonts()
senators <- read.csv(file.choose())
follows <- read.csv(file.choose())
senator_tweets <- readRDS(file.choose())
knitr::opts_chunk$set(echo = TRUE)
senator_tweets_nort <- senator_tweets %>% filter(is_retweet=="FALSE")
senator_tweets_nort <- merge(senator_tweets_nort, senators, by.x="screen_name", by.y="Official.Twitter", all.x=TRUE)
senator_tweets_nort$Day_Month_Yr <- floor_date(senator_tweets_nort$created_at, "day")
senator_tweets_nort_parkland_1404 <- subset(senator_tweets_nort, Day_Month_Yr=="2018-02-14")
senator_tweets_nort_parkland_1504 <- subset(senator_tweets_nort, Day_Month_Yr=="2018-02-15")
senator_tweets_nort_parkland_1604 <- subset(senator_tweets_nort, Day_Month_Yr=="2018-02-16")
rep_tweets_parkland_1404_uncollapsed <- subset(senator_tweets_nort_parkland_1404, Party.affiliation=="Republican Party")
dem_tweets_parkland_1404_uncollapsed <- subset(senator_tweets_nort_parkland_1404, Party.affiliation=="Democratic Party")
rep_tweets_parkland_1404 <- as.vector(glue::collapse(as.character(rep_tweets_parkland_1404_uncollapsed$text), sep = ";;;"))
dem_tweets_parkland_1404 <- as.vector(glue::collapse(as.character(dem_tweets_parkland_1404_uncollapsed$text), sep = ";;;"))
collapsedtweets_1404 <- as.data.frame(rbind(rep_tweets_parkland_1404, dem_tweets_parkland_1404))
collapsedtweets_1404 <- tibble::rownames_to_column(collapsedtweets_1404, "doc_id")
colnames(collapsedtweets_1404)[2] <- "text"
collapsedtweets_1404_source <- DataframeSource(collapsedtweets_1404)
collapsedtweets_1404_corpus <- VCorpus(collapsedtweets_1404_source)
clean_corpus <- function(corpus){
corpus <- tm_map(corpus, content_transformer(removeNumbers))
corpus <- tm_map(corpus, content_transformer(removePunctuation))
corpus <- tm_map(corpus, content_transformer(tolower))
corpus <- tm_map(corpus, content_transformer(removeWords), c(stopwords("en")))
corpus <- tm_map(corpus, content_transformer(stripWhitespace))
return(corpus)}
stemCompletion2 <- function(x, dictionary) {
x <- unlist(strsplit(as.character(x), " "))
x <- x[x != ""]
x <- stemCompletion(x, dictionary=dictionary)
x <- paste(x, sep="", collapse=" ")
PlainTextDocument(stripWhitespace(x))}
collapsedtweets_1404_clean <- clean_corpus(collapsedtweets_1404_corpus)
collapsedtweets_1404_stemmed <- tm_map(collapsedtweets_1404_clean, stemDocument)
collapsedtweets_1404_compl <- lapply(collapsedtweets_1404_stemmed, stemCompletion2, dictionary=collapsedblurbs_1404_clean)
collapsedtweets_1404_all <- as.VCorpus(collapsedtweets_1404_compl)
for (i in 1:dim(collapsedtweets_1404)[1]){collapsedtweets_1404_all[[i]]$meta$id <- collapsedtweets_1404[i,"doc_id"]}
collapsedtweets_1404_tdm <- TermDocumentMatrix(collapsedtweets_1404_all)
collapsedtweets_1404_m <- as.matrix(collapsedtweets_1404_tdm)
set.seed(2103)
comparison.cloud(collapsedtweets_1404_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1.6), title.size= 1, max.words = 100, family="Garamond")
```
collapsedtweets_1404_compl <- lapply(collapsedtweets_1404_stemmed, stemCompletion2, dictionary=collapsedtweets_1404_clean)
collapsedtweets_1404_all <- as.VCorpus(collapsedtweets_1404_compl)
for (i in 1:dim(collapsedtweets_1404)[1]){collapsedtweets_1404_all[[i]]$meta$id <- collapsedtweets_1404[i,"doc_id"]}
collapsedtweets_1404_tdm <- TermDocumentMatrix(collapsedtweets_1404_all)
collapsedtweets_1404_m <- as.matrix(collapsedtweets_1404_tdm)
set.seed(2103)
comparison.cloud(collapsedtweets_1404_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1.6), title.size= 1, max.words = 100, family="Garamond")
collapsedtweets_1404 <- as.data.frame(rbind(rep_tweets_parkland_1404, dem_tweets_parkland_1404))
collapsedtweets_1404$doc_id <- c("April 14 Republican Tweets", "April 14 Democrat Tweets")
colnames(collapsedtweets_1404)[2] <- "text"
collapsedtweets_1404_source <- DataframeSource(collapsedtweets_1404)
collapsedtweets_1404_corpus <- VCorpus(collapsedtweets_1404_source)
View(collapsedtweets_1404)
View(collapsedtweets_1404)
collapsedtweets_1404$doc_id <- c("April 14 Republican Tweets", "April 14 Democrat Tweets")
View(collapsedtweets_1404)
View(collapsedtweets_1404)
collapsedtweets_1404 <- as.data.frame(rbind(rep_tweets_parkland_1404, dem_tweets_parkland_1404))
collapsedtweets_1404$doc_id <- c("April 14 Republican Tweets", "April 14 Democrat Tweets")
colnames(collapsedtweets_1404)[1] <- "text"
collapsedtweets_1404_source <- DataframeSource(collapsedtweets_1404)
collapsedtweets_1404_corpus <- VCorpus(collapsedtweets_1404_source)
View(collapsedtweets_1404)
collapsedtweets_1404_clean <- clean_corpus(collapsedtweets_1404_corpus)
collapsedtweets_1404_stemmed <- tm_map(collapsedtweets_1404_clean, stemDocument)
collapsedtweets_1404_compl <- lapply(collapsedtweets_1404_stemmed, stemCompletion2, dictionary=collapsedtweets_1404_clean)
collapsedtweets_1404_all <- as.VCorpus(collapsedtweets_1404_compl)
for (i in 1:dim(collapsedtweets_1404)[1]){collapsedtweets_1404_all[[i]]$meta$id <- collapsedtweets_1404[i,"doc_id"]}
collapsedtweets_1404_tdm <- TermDocumentMatrix(collapsedtweets_1404_all)
collapsedtweets_1404_m <- as.matrix(collapsedtweets_1404_tdm)
set.seed(2103)
comparison.cloud(collapsedtweets_1404_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1.6), title.size= 1, max.words = 100, family="Garamond")
comparison.cloud(collapsedtweets_1404_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1.6), title.size= 1, max.words = 100, family="Garamond")
set.seed(2103)
comparison.cloud(collapsedtweets_1404_m, colors = c("firebrick", "royalblue"), scale=c(0.1,2), title.size= 1, max.words = 100, family="Garamond")
rep_tweets_parkland_1504_uncollapsed <- subset(senator_tweets_nort_parkland_1504, Party.affiliation=="Republican Party")
dem_tweets_parkland_1504_uncollapsed <- subset(senator_tweets_nort_parkland_1504, Party.affiliation=="Democratic Party")
rep_tweets_parkland_1504 <- as.vector(glue::collapse(as.character(rep_tweets_parkland_1504_uncollapsed$text), sep = ";;;"))
dem_tweets_parkland_1504 <- as.vector(glue::collapse(as.character(dem_tweets_parkland_1504_uncollapsed$text), sep = ";;;"))
collapsedtweets_1504 <- as.data.frame(rbind(rep_tweets_parkland_1404, dem_tweets_parkland_1504))
collapsedtweets_1504$doc_id <- c("April 14 Republican Tweets", "April 14 Democrat Tweets")
colnames(collapsedtweets_1504)[1] <- "text"
collapsedtweets_1504_source <- DataframeSource(collapsedtweets_1504)
collapsedtweets_1504_corpus <- VCorpus(collapsedtweets_1504_source)
collapsedtweets_1504_clean <- clean_corpus(collapsedtweets_1504_corpus)
collapsedtweets_1504_stemmed <- tm_map(collapsedtweets_1504_clean, stemDocument)
collapsedtweets_1504_compl <- lapply(collapsedtweets_1504_stemmed, stemCompletion2, dictionary=collapsedtweets_1404_clean)
rep_tweets_parkland_1504_uncollapsed <- subset(senator_tweets_nort_parkland_1504, Party.affiliation=="Republican Party")
dem_tweets_parkland_1504_uncollapsed <- subset(senator_tweets_nort_parkland_1504, Party.affiliation=="Democratic Party")
rep_tweets_parkland_1504 <- as.vector(glue::collapse(as.character(rep_tweets_parkland_1504_uncollapsed$text), sep = ";;;"))
dem_tweets_parkland_1504 <- as.vector(glue::collapse(as.character(dem_tweets_parkland_1504_uncollapsed$text), sep = ";;;"))
collapsedtweets_1504 <- as.data.frame(rbind(rep_tweets_parkland_1404, dem_tweets_parkland_1504))
collapsedtweets_1504$doc_id <- c("April 14 Republican Tweets", "April 14 Democrat Tweets")
colnames(collapsedtweets_1504)[1] <- "text"
collapsedtweets_1504_source <- DataframeSource(collapsedtweets_1504)
collapsedtweets_1504_corpus <- VCorpus(collapsedtweets_1504_source)
collapsedtweets_1504_clean <- clean_corpus(collapsedtweets_1504_corpus)
collapsedtweets_1504_stemmed <- tm_map(collapsedtweets_1504_clean, stemDocument)
collapsedtweets_1504_compl <- lapply(collapsedtweets_1504_stemmed, stemCompletion2, dictionary=collapsedtweets_1504_clean)
collapsedtweets_1504_all <- as.VCorpus(collapsedtweets_1504_compl)
for (i in 1:dim(collapsedtweets_1504)[1]){collapsedtweets_1504_all[[i]]$meta$id <- collapsedtweets_1504[i,"doc_id"]}
collapsedtweets_1504_tdm <- TermDocumentMatrix(collapsedtweets_1504_all)
collapsedtweets_1504_m <- as.matrix(collapsedtweets_1504_tdm)
set.seed(2103)
comparison.cloud(collapsedtweets_1504_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1.6), title.size= 1, max.words = 100, family="Garamond")
rep_tweets_parkland_1604_uncollapsed <- subset(senator_tweets_nort_parkland_1604, Party.affiliation=="Republican Party")
dem_tweets_parkland_1604_uncollapsed <- subset(senator_tweets_nort_parkland_1604, Party.affiliation=="Democratic Party")
rep_tweets_parkland_1604 <- as.vector(glue::collapse(as.character(rep_tweets_parkland_1604_uncollapsed$text), sep = ";;;"))
dem_tweets_parkland_1604 <- as.vector(glue::collapse(as.character(dem_tweets_parkland_1604_uncollapsed$text), sep = ";;;"))
collapsedtweets_1604 <- as.data.frame(rbind(rep_tweets_parkland_1604, dem_tweets_parkland_1604))
collapsedtweets_1604$doc_id <- c("April 14 Republican Tweets", "April 14 Democrat Tweets")
colnames(collapsedtweets_1604)[1] <- "text"
collapsedtweets_1604_source <- DataframeSource(collapsedtweets_1604)
collapsedtweets_1604_corpus <- VCorpus(collapsedtweets_1604_source)
collapsedtweets_1604_clean <- clean_corpus(collapsedtweets_1604_corpus)
collapsedtweets_1604_stemmed <- tm_map(collapsedtweets_1604_clean, stemDocument)
collapsedtweets_1604_compl <- lapply(collapsedtweets_1604_stemmed, stemCompletion2, dictionary=collapsedtweets_1604_clean)
collapsedtweets_1604_all <- as.VCorpus(collapsedtweets_1604_compl)
for (i in 1:dim(collapsedtweets_1604)[1]){collapsedtweets_1604_all[[i]]$meta$id <- collapsedtweets_1604[i,"doc_id"]}
collapsedtweets_1604_tdm <- TermDocumentMatrix(collapsedtweets_1604_all)
collapsedtweets_1604_m <- as.matrix(collapsedtweets_1604_tdm)
set.seed(2103)
comparison.cloud(collapsedtweets_1604_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1.6), title.size= 1, max.words = 100, family="Garamond")
par(mfrow=c(1,3))
set.seed(2103)
comparison.cloud(collapsedtweets_1404_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1.6), title.size= 1, max.words = 100, family="Garamond")
set.seed(2103)
comparison.cloud(collapsedtweets_1504_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1.6), title.size= 1, max.words = 100, family="Garamond")
set.seed(2103)
comparison.cloud(collapsedtweets_1604_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1.6), title.size= 1, max.words = 100, family="Garamond")
senator_tweets_nort_parkland_1704 <- subset(senator_tweets_nort, Day_Month_Yr=="2018-02-17")
rep_tweets_parkland_1404_uncollapsed <- subset(senator_tweets_nort_parkland_1404, Party.affiliation=="Republican Party")
dem_tweets_parkland_1404_uncollapsed <- subset(senator_tweets_nort_parkland_1404, Party.affiliation=="Democratic Party")
rep_tweets_parkland_1404 <- as.vector(glue::collapse(as.character(rep_tweets_parkland_1404_uncollapsed$text), sep = ";;;"))
dem_tweets_parkland_1404 <- as.vector(glue::collapse(as.character(dem_tweets_parkland_1404_uncollapsed$text), sep = ";;;"))
collapsedtweets_1404 <- as.data.frame(rbind(rep_tweets_parkland_1404, dem_tweets_parkland_1404))
collapsedtweets_1404$doc_id <- c("April 14 Republican Tweets", "April 14 Democrat Tweets")
colnames(collapsedtweets_1404)[1] <- "text"
collapsedtweets_1404_source <- DataframeSource(collapsedtweets_1404)
collapsedtweets_1404_corpus <- VCorpus(collapsedtweets_1404_source)
collapsedtweets_1404_clean <- clean_corpus(collapsedtweets_1404_corpus)
collapsedtweets_1404_stemmed <- tm_map(collapsedtweets_1404_clean, stemDocument)
collapsedtweets_1404_compl <- lapply(collapsedtweets_1404_stemmed, stemCompletion2, dictionary=collapsedtweets_1404_clean)
collapsedtweets_1404_all <- as.VCorpus(collapsedtweets_1404_compl)
for (i in 1:dim(collapsedtweets_1404)[1]){collapsedtweets_1404_all[[i]]$meta$id <- collapsedtweets_1404[i,"doc_id"]}
collapsedtweets_1404_tdm <- TermDocumentMatrix(collapsedtweets_1404_all)
collapsedtweets_1404_m <- as.matrix(collapsedtweets_1404_tdm)
rep_tweets_parkland_1504_uncollapsed <- subset(senator_tweets_nort_parkland_1504, Party.affiliation=="Republican Party")
dem_tweets_parkland_1504_uncollapsed <- subset(senator_tweets_nort_parkland_1504, Party.affiliation=="Democratic Party")
rep_tweets_parkland_1504 <- as.vector(glue::collapse(as.character(rep_tweets_parkland_1504_uncollapsed$text), sep = ";;;"))
dem_tweets_parkland_1504 <- as.vector(glue::collapse(as.character(dem_tweets_parkland_1504_uncollapsed$text), sep = ";;;"))
collapsedtweets_1504 <- as.data.frame(rbind(rep_tweets_parkland_1504, dem_tweets_parkland_1504))
collapsedtweets_1504$doc_id <- c("April 15 Republican Tweets", "April 15 Democrat Tweets")
colnames(collapsedtweets_1504)[1] <- "text"
collapsedtweets_1504_source <- DataframeSource(collapsedtweets_1504)
collapsedtweets_1504_corpus <- VCorpus(collapsedtweets_1504_source)
collapsedtweets_1504_clean <- clean_corpus(collapsedtweets_1504_corpus)
collapsedtweets_1504_stemmed <- tm_map(collapsedtweets_1504_clean, stemDocument)
collapsedtweets_1504_compl <- lapply(collapsedtweets_1504_stemmed, stemCompletion2, dictionary=collapsedtweets_1504_clean)
collapsedtweets_1504_all <- as.VCorpus(collapsedtweets_1504_compl)
for (i in 1:dim(collapsedtweets_1504)[1]){collapsedtweets_1504_all[[i]]$meta$id <- collapsedtweets_1504[i,"doc_id"]}
collapsedtweets_1504_tdm <- TermDocumentMatrix(collapsedtweets_1504_all)
collapsedtweets_1504_m <- as.matrix(collapsedtweets_1504_tdm)
rep_tweets_parkland_1604_uncollapsed <- subset(senator_tweets_nort_parkland_1604, Party.affiliation=="Republican Party")
dem_tweets_parkland_1604_uncollapsed <- subset(senator_tweets_nort_parkland_1604, Party.affiliation=="Democratic Party")
rep_tweets_parkland_1604 <- as.vector(glue::collapse(as.character(rep_tweets_parkland_1604_uncollapsed$text), sep = ";;;"))
dem_tweets_parkland_1604 <- as.vector(glue::collapse(as.character(dem_tweets_parkland_1604_uncollapsed$text), sep = ";;;"))
collapsedtweets_1604 <- as.data.frame(rbind(rep_tweets_parkland_1604, dem_tweets_parkland_1604))
collapsedtweets_1604$doc_id <- c("April 16 Republican Tweets", "April 16 Democrat Tweets")
colnames(collapsedtweets_1604)[1] <- "text"
collapsedtweets_1604_source <- DataframeSource(collapsedtweets_1604)
collapsedtweets_1604_corpus <- VCorpus(collapsedtweets_1604_source)
collapsedtweets_1604_clean <- clean_corpus(collapsedtweets_1604_corpus)
collapsedtweets_1604_stemmed <- tm_map(collapsedtweets_1604_clean, stemDocument)
collapsedtweets_1604_compl <- lapply(collapsedtweets_1604_stemmed, stemCompletion2, dictionary=collapsedtweets_1604_clean)
collapsedtweets_1604_all <- as.VCorpus(collapsedtweets_1604_compl)
for (i in 1:dim(collapsedtweets_1604)[1]){collapsedtweets_1604_all[[i]]$meta$id <- collapsedtweets_1604[i,"doc_id"]}
collapsedtweets_1604_tdm <- TermDocumentMatrix(collapsedtweets_1604_all)
collapsedtweets_1604_m <- as.matrix(collapsedtweets_1604_tdm)
rep_tweets_parkland_1704_uncollapsed <- subset(senator_tweets_nort_parkland_1704, Party.affiliation=="Republican Party")
dem_tweets_parkland_1704_uncollapsed <- subset(senator_tweets_nort_parkland_1704, Party.affiliation=="Democratic Party")
rep_tweets_parkland_1704 <- as.vector(glue::collapse(as.character(rep_tweets_parkland_1704_uncollapsed$text), sep = ";;;"))
dem_tweets_parkland_1704 <- as.vector(glue::collapse(as.character(dem_tweets_parkland_1704_uncollapsed$text), sep = ";;;"))
collapsedtweets_1704 <- as.data.frame(rbind(rep_tweets_parkland_1704, dem_tweets_parkland_1704))
collapsedtweets_1704$doc_id <- c("April 16 Republican Tweets", "April 16 Democrat Tweets")
colnames(collapsedtweets_1704)[1] <- "text"
collapsedtweets_1704_source <- DataframeSource(collapsedtweets_1704)
collapsedtweets_1704_corpus <- VCorpus(collapsedtweets_1704_source)
collapsedtweets_1704_clean <- clean_corpus(collapsedtweets_1704_corpus)
collapsedtweets_1704_stemmed <- tm_map(collapsedtweets_1704_clean, stemDocument)
collapsedtweets_1704_compl <- lapply(collapsedtweets_1704_stemmed, stemCompletion2, dictionary=collapsedtweets_1704_clean)
collapsedtweets_1704_all <- as.VCorpus(collapsedtweets_1704_compl)
for (i in 1:dim(collapsedtweets_1704)[1]){collapsedtweets_1704_all[[i]]$meta$id <- collapsedtweets_1704[i,"doc_id"]}
collapsedtweets_1704_tdm <- TermDocumentMatrix(collapsedtweets_1704_all)
collapsedtweets_1704_m <- as.matrix(collapsedtweets_1704_tdm)
par(mfrow=c(2,2))
set.seed(2103)
comparison.cloud(collapsedtweets_1404_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1.6), title.size= 1, max.words = 100, family="Garamond")
set.seed(2103)
comparison.cloud(collapsedtweets_1504_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1.6), title.size= 1, max.words = 100, family="Garamond")
set.seed(2103)
comparison.cloud(collapsedtweets_1604_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1.6), title.size= 1, max.words = 100, family="Garamond")
set.seed(2103)
comparison.cloud(collapsedtweets_1704_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1.6), title.size= 1, max.words = 100, family="Garamond")
par(mfrow=c(2,2))
par(mar=c(0.01,0.01,0.01,0.01))
set.seed(2103)
comparison.cloud(collapsedtweets_1404_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1), title.size= 1, max.words = 100, family="Garamond")
set.seed(2103)
comparison.cloud(collapsedtweets_1504_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1), title.size= 1, max.words = 100, family="Garamond")
set.seed(2103)
comparison.cloud(collapsedtweets_1604_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1), title.size= 1, max.words = 100, family="Garamond")
set.seed(2103)
comparison.cloud(collapsedtweets_1704_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1), title.size= 1, max.words = 100, family="Garamond")
par(mfrow=c(2,2))
par(mar=c(0.01,0.01,0.01,0.01))
set.seed(2103)
comparison.cloud(collapsedtweets_1404_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1.2), title.size= 1, max.words = 50, family="Garamond")
set.seed(2103)
comparison.cloud(collapsedtweets_1504_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1.2), title.size= 1, max.words = 50, family="Garamond")
set.seed(2103)
comparison.cloud(collapsedtweets_1604_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1.2), title.size= 1, max.words = 50, family="Garamond")
set.seed(2103)
comparison.cloud(collapsedtweets_1704_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1.2), title.size= 1, max.words = 50, family="Garamond")
par(mfrow=c(2,2))
par(mar=c(0.01,0.01,0.01,0.01))
set.seed(2103)
comparison.cloud(collapsedtweets_1404_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1.5), title.size= 1, max.words = 80, family="Garamond")
set.seed(2103)
comparison.cloud(collapsedtweets_1504_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1.5), title.size= 1, max.words = 80, family="Garamond")
set.seed(2103)
comparison.cloud(collapsedtweets_1604_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1.5), title.size= 1, max.words = 80, family="Garamond")
set.seed(2103)
comparison.cloud(collapsedtweets_1704_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1.5), title.size= 1, max.words = 80, family="Garamond")
par(mfrow=c(2,2))
par(mar=c(0.01,0.01,0.01,0.01))
set.seed(2103)
comparison.cloud(collapsedtweets_1404_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1.3), title.size= 1, max.words = 80, family="Garamond")
set.seed(2103)
comparison.cloud(collapsedtweets_1504_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1.3), title.size= 1, max.words = 80, family="Garamond")
set.seed(2103)
comparison.cloud(collapsedtweets_1604_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1.3), title.size= 1, max.words = 80, family="Garamond")
set.seed(2103)
comparison.cloud(collapsedtweets_1704_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1.3), title.size= 1, max.words = 80, family="Garamond")
par(mfrow=c(2,2))
par(mar=c(0.01,0.01,0.01,0.01))
set.seed(2103)
comparison.cloud(collapsedtweets_1404_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1.3), title.size= 1, max.words = 80, family="Garamond")
set.seed(2103)
comparison.cloud(collapsedtweets_1504_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1.3), title.size= 1, max.words = 80, family="Garamond")
set.seed(2103)
comparison.cloud(collapsedtweets_1604_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1.3), title.size= 1, max.words = 80, family="Garamond")
set.seed(2103)
comparison.cloud(collapsedtweets_1704_m, colors = c("firebrick", "royalblue"), scale=c(0.1,1.3), title.size= 1, max.words = 80, family="Garamond")
senator_tweets_rt <- senator_tweets %>% filter(is_retweet=="TRUE")
View(senator_tweets_rt)
View(senator_tweets_rt)
senator_tweets_rt <- senator_tweets_rt %>% mutate(extracted = str_match(text, "(RT|via)((?:[[:blank:]:]\\W*@\\w+)+)")[,3])
require(stringr)
senator_tweets_rt <- senator_tweets_rt %>% mutate(extracted = str_match(text, "(RT|via)((?:[[:blank:]:]\\W*@\\w+)+)")[,3])
senator_tweets_rt <- senator_tweets_rt %>% mutate(extracted = str_match(text, "(RT|via)((?:[[:blank:]:]\\W*@\\w+)+)")[,3]) %>% unnest()
senator_tweets_rt$test <- str_split_fixed(senator_tweets_rt$extracted, "", 2)
senator_tweets_rt$test <- str_split_fixed(senator_tweets_rt$extracted, " ", 2)
senator_tweets_rt$test <- str_split_fixed(senator_tweets_rt$extracted, ":.", 2)
senator_tweets_rt$test <- gsub(senator_tweets_rt$test, "@", "")
senator_tweets_rt$test <- str_split_fixed(senator_tweets_rt$extracted, ":.", 2)
senator_tweets_rt$test2 <- gsub("@", "", senator_tweets_rt$test)
senator_tweets_rt$extracted <- str_split_fixed(senator_tweets_rt$extracted, ":.", 2)
senator_tweets_rt$extracted <- gsub("@", "", senator_tweets_rt$extracted)
senator_tweets_rt$test <- NULL
senator_tweets_rt$test2 <- NULL
View(senators)
View(senators)
senator_tweets_rt_partyinfo <- merge(senator_tweets_nort, senators[,c(3,6)], by.x="screen_name", by.y="Official.Twitter")
senator_tweets_rt_partyinfo <- merge(senator_tweets_rt_partyinfo, senators[,c(3,6)], by.x="screen_name", by.y="Official.Twitter")
senator_tweets_rt_partyinfo <- merge(senator_tweets_rt, senators[,c(3,6)], by.x="screen_name", by.y="Official.Twitter")
colnames(senator_tweets_rt_partyinfo[colnames(senator_tweets_rt_partyinfo)=="Party.affiliation"] <- "SourceParty"
)
colnames(senator_tweets_rt_partyinfo[colnames(senator_tweets_rt_partyinfo)=="Party.affiliation"]) <- "SourceParty"
senator_tweets_rt_partyinfo <- merge(senator_tweets_rt_partyinfo, senators[,c(3,6)], by.x="extracted", by.y="Official.Twitter")
senator_tweets_rt_partyinfo <- merge(senator_tweets_rt_partyinfo, senators[,c(3,6)], by.x="extracted", by.y="Official.Twitter")
colnames(senator_tweets_rt_partyinfo[colnames(senator_tweets_rt_partyinfo)=="Party.affiliation"]) <- "RTParty"
View(senator_tweets_rt_partyinfo)
colnames(senator_tweets_rt_partyinfo[colnames(senator_tweets_rt_partyinfo)=="Party.affiliation"]) <- "SourceParty"
View(senator_tweets_rt_partyinfo)
senator_tweets_rt_partyinfo <- merge(senator_tweets_rt, senators[,c(3,6)], by.x="screen_name", by.y="Official.Twitter")
colnames(senator_tweets_rt_partyinfo)[colnames(senator_tweets_rt_partyinfo)=="Party.affiliation"] <- "SourceParty"
senator_tweets_rt_partyinfo <- merge(senator_tweets_rt_partyinfo, senators[,c(3,6)], by.x="extracted", by.y="Official.Twitter")
colnames(senator_tweets_rt_partyinfo)[colnames(senator_tweets_rt_partyinfo)=="Party.affiliation"] <- "RTParty"
senator_tweets_rt_partyinfo2 <- merge(senator_tweets_rt_partyinfo, senators[,c(3,6)], by.x="extracted", by.y="Official.Twitter")
colnames(senator_tweets_rt_partyinfo2)[colnames(senator_tweets_rt_partyinfo2)=="Party.affiliation"] <- "RTParty"
senator_tweets_rt_partyinfo <- merge(senator_tweets_rt_partyinfo, senators, by.x="extracted", by.y="Official.Twitter")
colnames(senator_tweets_rt_partyinfo)[colnames(senator_tweets_rt_partyinfo)=="Party.affiliation"] <- "RTParty"
View(senator_tweets_rt_partyinfo)
senator_tweets_rt_partyinfo <- merge(senator_tweets_rt, senators[,c(3,6)], by.x="extracted", by.y="Official.Twitter")
class(senator_tweets_rt_partyinfo$extracted)
senator_tweets_rt$extracted <- as.character(gsub("@", "", senator_tweets_rt$extracted))
senator_tweets_rt$extracted <- as.character(senator_tweets_rt$extracted )
test(as.character(senator_tweets_rt$extracted)
)
test <- as.character(senator_tweets_rt$extracted)
test
senator_tweets_rt <- senator_tweets_rt %>% mutate(extracted = str_match(text, "(RT|via)((?:[[:blank:]:]\\W*@\\w+)+)")[,3])
senator_tweets_rt$extracted <- str_split_fixed(senator_tweets_rt$extracted, ":.")
senator_tweets_rt$extracted <- str_split_fixed(senator_tweets_rt$extracted, ":.",1)
senator_tweets_rt$extracted <- str_split_fixed(senator_tweets_rt$extracted, ":.", 2)[,1]
senator_tweets_rt_partyinfo <- merge(senator_tweets_rt, senators[,c(3,6)], by.x="screen_name", by.y="Official.Twitter")
colnames(senator_tweets_rt_partyinfo)[colnames(senator_tweets_rt_partyinfo)=="Party.affiliation"] <- "SourceParty"
senator_tweets_rt_partyinfo <- merge(senator_tweets_rt_partyinfo, senators[,c(3,6)], by.x="extracted", by.y="Official.Twitter")
colnames(senator_tweets_rt_partyinfo)[colnames(senator_tweets_rt_partyinfo)=="Party.affiliation"] <- "RTParty"
senator_tweets_rt_partyinfo <- merge(senator_tweets_rt, senators[,c(3,6)], by.x="screen_name", by.y="Official.Twitter")
colnames(senator_tweets_rt_partyinfo)[colnames(senator_tweets_rt_partyinfo)=="Party.affiliation"] <- "SourceParty"
senator_tweets_rt <- senator_tweets_rt %>% mutate(extracted = str_match(text, "(RT|via)((?:[[:blank:]:]\\W*@\\w+)+)")[,3])
senator_tweets_rt$extracted <- str_split_fixed(senator_tweets_rt$extracted, ":.",2)[,1]
senator_tweets_rt$extracted <- gsub("@", "", senator_tweets_rt$extracted)
senator_tweets_rt$extracted <- gsub(" ", "", senator_tweets_rt$extracted)
senator_tweets_rt_partyinfo <- merge(senator_tweets_rt, senators[,c(3,6)], by.x="screen_name", by.y="Official.Twitter")
colnames(senator_tweets_rt_partyinfo)[colnames(senator_tweets_rt_partyinfo)=="Party.affiliation"] <- "SourceParty"
senator_tweets_rt_partyinfo <- merge(senator_tweets_rt_partyinfo, senators[,c(3,6)], by.x="extracted", by.y="Official.Twitter")
colnames(senator_tweets_rt_partyinfo)[colnames(senator_tweets_rt_partyinfo)=="Party.affiliation"] <- "RTParty"
senator_tweets_rt_bysenator <- senator_tweets_rt_partyinfo %>% group_by(screen_name) %>% mutate(RepublicanRetweet = tally(RTParty=="Republican Party"))
senator_tweets_rt_bysenator <- senator_tweets_rt_partyinfo %>% group_by(screen_name) %>% mutate(RepublicanRetweet = length(RTParty[RTParty=="Republican Party"]))
View(senator_tweets_rt_bysenator)
senator_tweets_rt_bysenator <- senator_tweets_rt_partyinfo %>% group_by(screen_name) %>% mutate(RepublicanRetweet = length(RTParty[RTParty=="Republican Party"])) %>% mutate(DemocraticRetweet = length(RTParty[RTParty=="Democratic Party"]))
senator_tweets_rt_bysenator <- senator_tweets_rt_bysenator[,c("screen_name", "SourceParty", "RepublicanRetweet", "DemocraticRetweet")]
senator_tweets_rt_bysenator <- senator_tweets_rt_bysenator[unique(senator_tweets_rt_bysenator),]
senator_tweets_rt_bysenator <- senator_tweets_rt_bysenator[!is.duplicated(senator_tweets_rt_bysenator),]
senator_tweets_rt_bysenator <- senator_tweets_rt_bysenator[!duplicated(senator_tweets_rt_bysenator),]
ggplot(senator_tweets_rt_bysenator, aes(x = DemocraticRetweet, y = RepublicanRetweet, label = screen_name)) + geom_point(aes(color=SourceParty), alpha = 0.5) + scale_size(range = c(1, 10)) + geom_text_repel(aes(label=Country), size=2.5, family="Garamond") + scale_color_manual(values = c("royalblue", "seagreen", "firebrick")) + xlab('Democratic Party Retweets') + ylab('Republican Party Retweets') + guides(color=guide_legend(title="Senator Party")) + ggtitle("Retweets of Senators by Party") + theme_tufte() +theme(legend.position = "right", legend.title.align=0.5, plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"))
require(ggrepel)
ggplot(senator_tweets_rt_bysenator, aes(x = DemocraticRetweet, y = RepublicanRetweet, label = screen_name)) + geom_point(aes(color=SourceParty), alpha = 0.5) + scale_size(range = c(1, 10)) + geom_text_repel(aes(label=Country), size=2.5, family="Garamond") + scale_color_manual(values = c("royalblue", "seagreen", "firebrick")) + xlab('Democratic Party Retweets') + ylab('Republican Party Retweets') + guides(color=guide_legend(title="Senator Party")) + ggtitle("Retweets of Senators by Party") + theme_tufte() +theme(legend.position = "right", legend.title.align=0.5, plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"))
ggplot(senator_tweets_rt_bysenator, aes(x = DemocraticRetweet, y = RepublicanRetweet, label = screen_name)) + geom_point(aes(color=SourceParty), alpha = 0.5) + scale_size(range = c(1, 10)) + geom_text_repel(aes(label=screen_name), size=2.5, family="Garamond") + scale_color_manual(values = c("royalblue", "seagreen", "firebrick")) + xlab('Democratic Party Retweets') + ylab('Republican Party Retweets') + guides(color=guide_legend(title="Senator Party")) + ggtitle("Retweets of Senators by Party") + theme_tufte() +theme(legend.position = "right", legend.title.align=0.5, plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"))
ggplot(senator_tweets_rt_bysenator, aes(x = DemocraticRetweet, y = RepublicanRetweet, label = screen_name)) + geom_point(aes(color=SourceParty), alpha = 0.5) + scale_size(range = c(1, 10)) + geom_text(aes(label=screen_name), size=2.5, family="Garamond") + scale_color_manual(values = c("royalblue", "seagreen", "firebrick")) + xlab('Democratic Party Retweets') + ylab('Republican Party Retweets') + guides(color=guide_legend(title="Senator Party")) + ggtitle("Retweets of Senators by Party") + theme_tufte() +theme(legend.position = c(0.8,0.8), legend.title.align=0.5, plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"))
ggplot(senator_tweets_rt_bysenator, aes(x = DemocraticRetweet, y = RepublicanRetweet, label = screen_name)) + geom_point(aes(color=SourceParty), alpha = 0.5) + scale_size(range = c(1, 10)) + geom_text(aes(label=screen_name), size=2.5, family="Garamond", check_overlap=TRUE, hjust=1) + scale_color_manual(values = c("royalblue", "seagreen", "firebrick")) + xlab('Democratic Party Retweets') + ylab('Republican Party Retweets') + guides(color=guide_legend(title="Senator Party")) + ggtitle("Retweets of Senators by Party") + theme_tufte() +theme(legend.position = c(0.8,0.8), legend.title.align=0.5, plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"))
ggplot(senator_tweets_rt_bysenator, aes(x = DemocraticRetweet, y = RepublicanRetweet, label = screen_name)) + geom_point(aes(color=SourceParty), alpha = 0.5) + scale_size(range = c(1, 10)) + geom_text(aes(label=screen_name), size=2.5, family="Garamond", check_overlap=TRUE, hjust=-2) + scale_color_manual(values = c("royalblue", "seagreen", "firebrick")) + xlab('Democratic Party Retweets') + ylab('Republican Party Retweets') + guides(color=guide_legend(title="Senator Party")) + ggtitle("Retweets of Senators by Party") + theme_tufte() +theme(legend.position = c(0.8,0.8), legend.title.align=0.5, plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"))
ggplot(senator_tweets_rt_bysenator, aes(x = DemocraticRetweet, y = RepublicanRetweet, label = screen_name)) + geom_point(aes(color=SourceParty), alpha = 0.5) + scale_size(range = c(1, 10)) + geom_text(aes(label=screen_name), size=2.5, family="Garamond", check_overlap=TRUE, hjust=-1) + scale_color_manual(values = c("royalblue", "seagreen", "firebrick")) + xlab('Democratic Party Retweets') + ylab('Republican Party Retweets') + guides(color=guide_legend(title="Senator Party")) + ggtitle("Retweets of Senators by Party") + theme_tufte() +theme(legend.position = c(0.8,0.8), legend.title.align=0.5, plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"))
ggplot(senator_tweets_rt_bysenator, aes(x = DemocraticRetweet, y = RepublicanRetweet, label = screen_name)) + geom_point(aes(color=SourceParty), alpha = 0.5) + scale_size(range = c(1, 10)) + geom_text(aes(label=screen_name), size=2.5, family="Garamond", check_overlap=TRUE, hjust=-0.5) + scale_color_manual(values = c("royalblue", "seagreen", "firebrick")) + xlab('Democratic Party Retweets') + ylab('Republican Party Retweets') + guides(color=guide_legend(title="Senator Party")) + ggtitle("Retweets of Senators by Party") + theme_tufte() +theme(legend.position = c(0.8,0.8), legend.title.align=0.5, plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"))
ggplot(senator_tweets_rt_bysenator, aes(x = DemocraticRetweet, y = RepublicanRetweet, label = screen_name)) + geom_point(aes(color=SourceParty), alpha = 0.5) + scale_size(range = c(1, 10)) + geom_text(aes(label=screen_name), size=2.5, family="Garamond", check_overlap=TRUE, hjust=0) + scale_color_manual(values = c("royalblue", "seagreen", "firebrick")) + xlab('Democratic Party Retweets') + ylab('Republican Party Retweets') + guides(color=guide_legend(title="Senator Party")) + ggtitle("Retweets of Senators by Party") + theme_tufte() +theme(legend.position = c(0.8,0.8), legend.title.align=0.5, plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"))
ggplot(senator_tweets_rt_bysenator, aes(x = DemocraticRetweet, y = RepublicanRetweet, label = screen_name)) + geom_point(aes(color=SourceParty), alpha = 0.5) + scale_size(range = c(1, 10)) + geom_text(aes(label=screen_name), size=2.5, family="Garamond", check_overlap=TRUE, hjust=-0.1, vjust=1) + scale_color_manual(values = c("royalblue", "seagreen", "firebrick")) + xlab('Democratic Party Retweets') + ylab('Republican Party Retweets') + guides(color=guide_legend(title="Senator Party")) + ggtitle("Retweets of Senators by Party") + theme_tufte() +theme(legend.position = c(0.8,0.8), legend.title.align=0.5, plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"))
ggplot(senator_tweets_rt_bysenator, aes(x = DemocraticRetweet, y = RepublicanRetweet, label = screen_name)) + geom_point(aes(color=SourceParty), alpha = 0.5) + scale_size(range = c(1, 10)) + geom_text(aes(label=screen_name), size=2.5, family="Garamond", check_overlap=TRUE, hjust=-0.1, vjust=-0.1) + scale_color_manual(values = c("royalblue", "seagreen", "firebrick")) + xlab('Democratic Party Retweets') + ylab('Republican Party Retweets') + guides(color=guide_legend(title="Senator Party")) + ggtitle("Retweets of Senators by Party") + theme_tufte() +theme(legend.position = c(0.8,0.8), legend.title.align=0.5, plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"))
ggplot(senator_tweets_rt_bysenator, aes(x = DemocraticRetweet, y = RepublicanRetweet, label = screen_name)) + geom_point(aes(color=SourceParty), alpha = 0.5) + scale_size(range = c(1, 10)) + geom_text(aes(label=screen_name), size=2.5, family="Garamond", check_overlap=TRUE, hjust=-0.1, vjust=-0.2) + scale_color_manual(values = c("royalblue", "seagreen", "firebrick")) + xlab('Democratic Party Retweets') + ylab('Republican Party Retweets') + guides(color=guide_legend(title="Senator Party")) + ggtitle("Retweets of Senators by Party") + theme_tufte() +theme(legend.position = c(0.8,0.8), legend.title.align=0.5, plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"))
ggplot(senator_tweets_rt_bysenator, aes(x = DemocraticRetweet, y = RepublicanRetweet, label = screen_name)) + geom_point(aes(color=SourceParty), alpha = 0.3) + scale_size(range = c(1, 10)) + geom_text(aes(label=screen_name), size=2.5, family="Garamond", check_overlap=TRUE, hjust=-0.1, vjust=-0.2) + scale_color_manual(values = c("royalblue", "seagreen", "firebrick")) + xlab('Democratic Party Retweets') + ylab('Republican Party Retweets') + guides(color=guide_legend(title="Senator Party")) + ggtitle("Retweets of Senators by Party") + theme_tufte() +theme(legend.position = c(0.8,0.8), legend.title.align=0.5, plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"))
ggplot(senator_tweets_rt_bysenator, aes(x = DemocraticRetweet, y = RepublicanRetweet, label = screen_name)) + geom_point(aes(color=SourceParty), alpha = 0.5) + scale_size(range = c(1, 10)) + geom_text(aes(label=screen_name), size=2.5, family="Garamond", check_overlap=TRUE, hjust=-0.1, vjust=-0.2) + scale_color_manual(values = c("royalblue", "seagreen", "firebrick")) + xlab('Democratic Party Retweets') + ylab('Republican Party Retweets') + guides(color=guide_legend(title="Senator Party")) + ggtitle("Retweets of Senators by Party") + theme_tufte() +theme(legend.position = c(0.8,0.8), legend.title.align=0.5, plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"))
senator_tweets_nort_wmentions <- unnest(senator_tweets_nort, mentions_screen_name, .drop=FALSE)
senator_tweets_nort_wmentions <- senator_tweets_nort_wmentions[!is.na(senator_tweets_nort_wmentions$mentions_screen_name),]
View(senator_tweets_nort_wmentions)
senator_tweets_nort_wmentions <- senator_tweets_nort_wmentions  %>% filter(screen_name %in% senators$Official.Twitter)
senator_tweets_nort_wmentions <- senator_tweets_nort_wmentions  %>% filter(mentions_screen_name %in% senators$Official.Twitter)
View(senator_tweets_nort_wmentions)
senator_mentions_edgelist <- senator_tweets_nort_wmentions[,c("screen_name", "mentions_screen_name")]
View(senator_mentions_edgelist)
mentions_matrix <- igraph::get.adjacency(graph.data.frame(senator_mentions_edgelist), sparse=FALSE)
View(mentions_matrix)
mentions_network <- igraph::graph.adjacency(as.matrix(mentions_matrix),mode="undirected",weighted=TRUE, diag = F)
plot(mentions_network)
V(mentions_network)$Indegree <- igraph::degree(mentions_network, mode="in")
V(mentions_network)$Outdegree <- igraph::degree(mentions_network, mode="out")
V(mentions_network)$Party=as.character(senators$Party.affiliation[match(V(mentions_network)$name,senators$Official.Twitter)])
set.seed(2103)
mentions_network_df <- ggnetwork(mentions_network, layout = "kamadakawai", cell.jitter = 0.75)
ggplot(mentions_network_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=weight, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Mentions Network of Senators') + theme_tufte() + theme(plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) +  guides(shape=guide_legend(title='Most Central Senators'))
summary(mentions_network)
View(mentions_network_df)
ggplot(mentions_network_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=mentions_network_df$weight, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Mentions Network of Senators') + theme_tufte() + theme(plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) +  guides(shape=guide_legend(title='Most Central Senators'))
mentions_network_df <- mentions_network_df[!is.na(mentions_network_df$weight),]
ggplot(mentions_network_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=mentions_network_df$weight, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Mentions Network of Senators') + theme_tufte() + theme(plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) +  guides(shape=guide_legend(title='Most Central Senators'))
ggplot(mentions_network_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=mentions_network_df$weight, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=sqrt(mentions_network_df$Indegree)), alpha=0.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Mentions Network of Senators') + theme_tufte() + theme(plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) +  guides(shape=guide_legend(title='Most Central Senators'))
ggplot(mentions_network_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=mentions_network_df$weight, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party), alpha=0.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Mentions Network of Senators') + theme_tufte() + theme(plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) +  guides(shape=guide_legend(title='Most Central Senators'))
ggplot(mentions_network_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=sqrt(mentions_network_df$weight), arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Mentions Network of Senators') + theme_tufte() + theme(plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) +  guides(shape=guide_legend(title='Most Central Senators'))
ggplot(mentions_network_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.01, size=log(mentions_network_df$weight), arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Mentions Network of Senators') + theme_tufte() + theme(plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) +  guides(shape=guide_legend(title='Most Central Senators'))
ggplot(mentions_network_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.05, size=log(mentions_network_df$weight), arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Mentions Network of Senators') + theme_tufte() + theme(plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) +  guides(shape=guide_legend(title='Most Central Senators'))
ggplot(mentions_network_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.05, size=sqrt(mentions_network_df$weight), arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Mentions Network of Senators') + theme_tufte() + theme(plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) +  guides(shape=guide_legend(title='Most Central Senators'))
ggplot(mentions_network_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=log(mentions_network_df$weight), arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Mentions Network of Senators') + theme_tufte() + theme(plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) +  guides(shape=guide_legend(title='Most Central Senators'))
ggplot(mentions_network_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.05, size=log(mentions_network_df$weight), arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Mentions Network of Senators') + theme_tufte() + theme(plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) +  guides(shape=guide_legend(title='Most Central Senators'))
senators <- senators %>% filter(Official.Twitter %in% follows$source)
follows <- subset(follows, following=="TRUE")
follows <- follows  %>% filter(source %in% senators$Official.Twitter)
follows <- follows  %>% filter(target %in% senators$Official.Twitter)
edgelist <- follows[,c(1,2)]
outdegree <- follows %>% group_by(source) %>% summarise(outdegree=length(target))
indegree <- follows %>% group_by(target) %>% summarise(indegree=length(source))
top3outdegree <- as.data.frame((outdegree[order(-outdegree$outdegree),])[c(1:3),])
top3indegree <- as.data.frame((indegree[order(-indegree$indegree),])[c(1:3),])
degreestats <- merge(outdegree, indegree, by.x="source", by.y="target", all.x=T)
senators_degreestats <- merge(senators, degreestats, by.y="source", by.x="Official.Twitter", all.x=T)
matrix <- igraph::get.adjacency(graph.data.frame(edgelist), sparse=FALSE)
network <- igraph::graph.adjacency(as.matrix(matrix),mode="directed",weighted=NULL, diag = F)
V(network)$Indegree <- igraph::degree(network, mode="in")
V(network)$Outdegree <- igraph::degree(network, mode="out")
V(network)$Party=as.character(senators$Party.affiliation[match(V(network)$name,senators$Official.Twitter)])
wc <- cluster_walktrap(network)
members <- membership(wc)
V(network)$Clusteridentification <- members
set.seed(2103)
senatorsnetwork_df <- ggnetwork(network, layout = "kamadakawai", cell.jitter = 0.75)
View(senatorsnetwork_df)
senatorsnetwork_withcluster_df <- ggnetwork(network, layout = "kamadakawai", cell.jitter = 0.75)
ggplot(senatorsnetwork_withcluster_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3outdegree$source), aes(shape='17'), size=2) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3indegree$target), aes(shape='18'), size=2.5) + geom_nodetext_repel(aes(label = vertex.names, color=Clusteridentification), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators') + theme_tufte() + theme(plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) + scale_shape_manual(labels = c("Highest Indegree Senators", "Highest Outdegree Senators"), values = c(17, 18)) +  guides(shape=guide_legend(title='Most Central Senators'))
ggplot(senatorsnetwork_withcluster_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(fill=Party, size=Indegree), alpha=0.5) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3outdegree$source), aes(shape='17'), size=2) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3indegree$target), aes(shape='18'), size=2.5) + geom_nodetext_repel(aes(label = vertex.names, color=Clusteridentification), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators') + theme_tufte() + theme(plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_fill_manual(values = c("royalblue", "seagreen", "firebrick")) + scale_shape_manual(labels = c("Highest Indegree Senators", "Highest Outdegree Senators"), values = c(17, 18)) +  guides(shape=guide_legend(title='Most Central Senators'))
set.seed(2103)
senatorsnetwork_df <- ggnetwork(network, layout = "kamadakawai", cell.jitter = 0.75)
ggplot(senatorsnetwork_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3outdegree$source), aes(shape='17'), size=2) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3indegree$target), aes(shape='18'), size=2.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators') + theme_tufte() + theme(plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) + scale_shape_manual(labels = c("Highest Indegree Senators", "Highest Outdegree Senators"), values = c(17, 18)) +  guides(shape=guide_legend(title='Most Central Senators'))
V(network)$Clusteridentification <- as.character(members)
set.seed(2103)
senatorsnetwork_withcluster_df <- ggnetwork(network, layout = "kamadakawai", cell.jitter = 0.75)
ggplot(senatorsnetwork_withcluster_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodetext_repel(aes(label = vertex.names, color=Clusteridentification), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators') + theme_tufte() + theme(plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_color_manual(values = c("royalblue", "seagreen", "firebrick")) +  guides(shape=guide_legend(title='Most Central Senators'))
set.seed(2103)
senatorsnetwork_withcluster_df <- ggnetwork(network, layout = "kamadakawai", cell.jitter = 0.75)
ggplot(senatorsnetwork_withcluster_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(fill=as.factor(Party), size=Indegree), alpha=0.5) + geom_nodetext_repel(aes(label = vertex.names, color=Clusteridentification), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators') + theme_tufte() + theme(plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_fill_manual(values = c("royalblue", "seagreen", "firebrick")) + scale_colour_manual(values = c("royalblue", "firebrick")) + guides(shape=guide_legend(title='Most Central Senators'))
ggplot(senatorsnetwork_withcluster_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=as.factor(Party), size=Indegree), alpha=0.5) + geom_nodetext_repel(aes(label = vertex.names, fill=Clusteridentification), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators') + theme_tufte() + theme(plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_color_manual(values = c("royalblue", "seagreen", "firebrick")) + scale_fill_manual(values = c("royalblue", "firebrick")) + guides(shape=guide_legend(title='Most Central Senators'))
ggplot(senatorsnetwork_withcluster_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=as.factor(Party), size=Indegree), alpha=0.5) + geom_nodetext_repel(aes(label = vertex.names, color=Clusteridentification), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators') + theme_tufte() + theme(plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_color_manual(values = c("royalblue", "seagreen", "firebrick", "royalblue", "firebrick")) + guides(shape=guide_legend(title='Most Central Senators'))
ggplot(senatorsnetwork_withcluster_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=as.factor(Party), size=Indegree), alpha=0.5) + geom_nodetext_repel(aes(label = vertex.names, color=Clusteridentification), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators') + theme_tufte() + theme(plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_color_manual(values = c("royalblue", "firebrick", "royalblue", "seagreen", "firebrick")) + guides(shape=guide_legend(title='Most Central Senators'))
ggplot(senatorsnetwork_withcluster_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodetext_repel(aes(label = vertex.names, color=Clusteridentification), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators') + theme_tufte() + theme(plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_color_manual(values = c("firebrick", "royalblue", "royalblue", "seagreen", "firebrick")) + guides(shape=guide_legend(title='Most Central Senators'))
ggplot(senatorsnetwork_withcluster_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodetext_repel(aes(label = vertex.names, color=Clusteridentification), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators with Cluster Identification') + theme_tufte() + theme(plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_color_manual(breaks=c("Democratic Party","Independent","Republican Party"), values = c("firebrick", "royalblue", "royalblue", "seagreen", "firebrick")) + guides(shape=guide_legend(title='Most Central Senators'))
ggplot(senatorsnetwork_withcluster_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodetext_repel(aes(label = vertex.names, color=Clusteridentification), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators with Cluster Identification') + theme_tufte() + theme(legend.position = c(0.1,0.1), plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_color_manual(breaks=c("Democratic Party","Independent","Republican Party"), values = c("firebrick", "royalblue", "royalblue", "seagreen", "firebrick")) + guides(shape=guide_legend(title='Most Central Senators'))
ggplot(senatorsnetwork_withcluster_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodetext_repel(aes(label = vertex.names, color=Clusteridentification), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators with Cluster Identification') + theme_tufte() + theme(legend.position = c(0.1,0.9), legend.box = "horizontal", plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_color_manual(breaks=c("Democratic Party","Independent","Republican Party"), values = c("firebrick", "royalblue", "royalblue", "seagreen", "firebrick"))
ggplot(senatorsnetwork_withcluster_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodetext_repel(aes(label = vertex.names, color=Clusteridentification), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators with Cluster Identification') + theme_tufte() + theme(legend.position = c(0.9,0.1), legend.box = "horizontal", plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_color_manual(breaks=c("Democratic Party","Independent","Republican Party"), values = c("firebrick", "royalblue", "royalblue", "seagreen", "firebrick"))
ggplot(senatorsnetwork_withcluster_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodetext_repel(aes(label = vertex.names, color=Clusteridentification), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators with Cluster Identification') + theme_tufte() + theme(legend.position = c(0.8,0.1), legend.box = "horizontal", plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_color_manual(breaks=c("Democratic Party","Independent","Republican Party"), values = c("firebrick", "royalblue", "royalblue", "seagreen", "firebrick"))
ggplot(senatorsnetwork_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3outdegree$source), aes(shape='17'), size=2) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3indegree$target), aes(shape='18'), size=2.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators') + theme_tufte() + theme(plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) + scale_shape_manual(labels = c("Highest Indegree Senators", "Highest Outdegree Senators"), values = c(17, 18)) +  guides(shape=guide_legend(title='Most Central Senators'))
ggplot(mentions_network_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.05, size=log(mentions_network_df$weight), arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Mentions Network of Senators') + theme_tufte() + theme(plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) +  guides(shape=guide_legend(title='Most Central Senators'))
ggplot(mentions_network_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.05, size=log(mentions_network_df$weight), arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Mentions Network of Senators') + theme_tufte() + theme(legend.position = c(0.2,0.1), legend.box = "horizontal",plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) +  guides(shape=guide_legend(title='Most Central Senators'))
set.seed(2102)
mentions_network_df <- ggnetwork(mentions_network, layout = "kamadakawai", cell.jitter = 0.75)
mentions_network_df <- mentions_network_df[!is.na(mentions_network_df$weight),]
ggplot(mentions_network_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.05, size=log(mentions_network_df$weight), arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Mentions Network of Senators') + theme_tufte() + theme(plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) +  guides(shape=guide_legend(title='Most Central Senators'))
ggplot(mentions_network_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.05, size=log(mentions_network_df$weight), arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Mentions Network of Senators') + theme_tufte() + theme(legend.position = "right", plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) +  guides(shape=guide_legend(title='Most Central Senators'))
ggplot(mentions_network_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.05, size=log(mentions_network_df$weight), arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Mentions Network of Senators') + theme_tufte() + theme(legend.position = c(0.2,0.1), legend.box="horizontal", plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) +  guides(shape=guide_legend(title='Most Central Senators'))
set.seed(2102)
senatorsnetwork_df <- ggnetwork(network, layout = "kamadakawai", cell.jitter = 0.75)
ggplot(senatorsnetwork_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3outdegree$source), aes(shape='17'), size=2) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3indegree$target), aes(shape='18'), size=2.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators') + theme_tufte() + theme(plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) + scale_shape_manual(labels = c("Highest Indegree Senators", "Highest Outdegree Senators"), values = c(17, 18)) +  guides(shape=guide_legend(title='Most Central Senators'))
ggplot(senatorsnetwork_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3outdegree$source), aes(shape='17'), size=2) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3indegree$target), aes(shape='18'), size=2.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators') + theme_tufte() + theme(legend.position = c(0.2,0.1), plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) + scale_shape_manual(labels = c("Highest Indegree Senators", "Highest Outdegree Senators"), values = c(17, 18)) +  guides(shape=guide_legend(title='Most Central Senators'))
ggplot(senatorsnetwork_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3outdegree$source), aes(shape='17'), size=2) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3indegree$target), aes(shape='18'), size=2.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators') + theme_tufte() + theme(legend.position = c(0.2,0.2), plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) + scale_shape_manual(labels = c("Highest Indegree Senators", "Highest Outdegree Senators"), values = c(17, 18)) +  guides(shape=guide_legend(title='Most Central Senators', order=3))
ggplot(senatorsnetwork_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3outdegree$source), aes(shape='17'), size=2) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3indegree$target), aes(shape='18'), size=2.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators') + theme_tufte() + theme(legend.position = c(0.2,0.2), plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) + scale_shape_manual(labels = c("Highest Indegree Senators", "Highest Outdegree Senators"), values = c(17, 18)) +  guides(shape=guide_legend(title='Most Central Senators', order=3), color=guide_legend(order=2), size=guide_legend(order=1))
set.seed(2101)
senatorsnetwork_df <- ggnetwork(network, layout = "kamadakawai", cell.jitter = 0.75)
ggplot(senatorsnetwork_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3outdegree$source), aes(shape='17'), size=2) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3indegree$target), aes(shape='18'), size=2.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators') + theme_tufte() + theme(legend.position = c(0.2,0.2), plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) + scale_shape_manual(labels = c("Highest Indegree Senators", "Highest Outdegree Senators"), values = c(17, 18)) +  guides(shape=guide_legend(title='Most Central Senators', order=3), color=guide_legend(order=2), size=guide_legend(order=1))
ggplot(senatorsnetwork_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3outdegree$source), aes(shape='17'), size=2) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3indegree$target), aes(shape='18'), size=2.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators') + theme_tufte() + theme(legend.position = c(0.8,0.8), plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) + scale_shape_manual(labels = c("Highest Indegree Senators", "Highest Outdegree Senators"), values = c(17, 18)) +  guides(shape=guide_legend(title='Most Central Senators', order=3), color=guide_legend(order=2), size=guide_legend(order=1))
set.seed(2100)
senatorsnetwork_df <- ggnetwork(network, layout = "kamadakawai", cell.jitter = 0.75)
ggplot(senatorsnetwork_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3outdegree$source), aes(shape='17'), size=2) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3indegree$target), aes(shape='18'), size=2.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators') + theme_tufte() + theme(legend.position = c(0.8,0.8), plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) + scale_shape_manual(labels = c("Highest Indegree Senators", "Highest Outdegree Senators"), values = c(17, 18)) +  guides(shape=guide_legend(title='Most Central Senators', order=3), color=guide_legend(order=2), size=guide_legend(order=1))
ggplot(senatorsnetwork_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3outdegree$source), aes(shape='17'), size=2) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3indegree$target), aes(shape='18'), size=2.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators') + theme_tufte() + theme(legend.position = c(0.7,0.2), plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) + scale_shape_manual(labels = c("Highest Indegree Senators", "Highest Outdegree Senators"), values = c(17, 18)) +  guides(shape=guide_legend(title='Most Central Senators'))
ggplot(senatorsnetwork_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3outdegree$source), aes(shape='17'), size=2) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3indegree$target), aes(shape='18'), size=2.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators') + theme_tufte() + theme(legend.position = c(0.2,0.7), plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) + scale_shape_manual(labels = c("Highest Indegree Senators", "Highest Outdegree Senators"), values = c(17, 18)) +  guides(shape=guide_legend(title='Most Central Senators'))
ggplot(senatorsnetwork_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3outdegree$source), aes(shape='17'), size=2) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3indegree$target), aes(shape='18'), size=2.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators') + theme_tufte() + theme(legend.position = c(0.2,0.75), plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) + scale_shape_manual(labels = c("Highest Indegree Senators", "Highest Outdegree Senators"), values = c(17, 18)) +  guides(shape=guide_legend(title='Most Central Senators'))
ggplot(senatorsnetwork_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3outdegree$source), aes(shape='17'), size=2) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3indegree$target), aes(shape='18'), size=2.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators') + theme_tufte() + theme(legend.position = c(0.2,0.73), plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) + scale_shape_manual(labels = c("Highest Indegree Senators", "Highest Outdegree Senators"), values = c(17, 18)) +  guides(shape=guide_legend(title='Most Central Senators'))
ggplot(senatorsnetwork_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3outdegree$source), aes(shape='17'), size=2) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3indegree$target), aes(shape='18'), size=2.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators') + theme_tufte() + theme(legend.position = c(0.1,0.73), plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) + scale_shape_manual(labels = c("Highest Indegree Senators", "Highest Outdegree Senators"), values = c(17, 18)) +  guides(shape=guide_legend(title='Most Central Senators'))
ggplot(senatorsnetwork_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.5) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3outdegree$source), aes(shape='17'), size=2) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3indegree$target), aes(shape='18'), size=2.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators') + theme_tufte() + theme(legend.position = c(0.15,0.73), plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) + scale_shape_manual(labels = c("Highest Indegree Senators", "Highest Outdegree Senators"), values = c(17, 18)) +  guides(shape=guide_legend(title='Most Central Senators'))
setwd("~/Desktop/Data Viz/Data Vis Assignment 4")
set.seed(2102)
senatorsnetwork_df <- ggnetwork(network, layout = "kamadakawai", cell.jitter = 0.75)
ggplot(senatorsnetwork_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.3) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3outdegree$source), aes(shape='17'), size=2) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3indegree$target), aes(shape='18'), size=2.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators') + theme_tufte() + theme(legend.position = "right", plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) + scale_shape_manual(labels = c("Highest Indegree Senators", "Highest Outdegree Senators"), values = c(17, 18)) +  guides(shape=guide_legend(title='Most Central Senators'))
set.seed(2104)
senatorsnetwork_df <- ggnetwork(network, layout = "kamadakawai", cell.jitter = 0.75)
ggplot(senatorsnetwork_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.3) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3outdegree$source), aes(shape='17'), size=2) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3indegree$target), aes(shape='18'), size=2.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators') + theme_tufte() + theme(legend.position = "right", plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) + scale_shape_manual(labels = c("Highest Indegree Senators", "Highest Outdegree Senators"), values = c(17, 18)) +  guides(shape=guide_legend(title='Most Central Senators'))
set.seed(2105)
senatorsnetwork_df <- ggnetwork(network, layout = "kamadakawai", cell.jitter = 0.75)
ggplot(senatorsnetwork_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.3) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3outdegree$source), aes(shape='17'), size=2) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3indegree$target), aes(shape='18'), size=2.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators') + theme_tufte() + theme(legend.position = "right", plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) + scale_shape_manual(labels = c("Highest Indegree Senators", "Highest Outdegree Senators"), values = c(17, 18)) +  guides(shape=guide_legend(title='Most Central Senators'))
set.seed(2106)
senatorsnetwork_df <- ggnetwork(network, layout = "kamadakawai", cell.jitter = 0.75)
ggplot(senatorsnetwork_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.3) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3outdegree$source), aes(shape='17'), size=2) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3indegree$target), aes(shape='18'), size=2.5) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators') + theme_tufte() + theme(legend.position = "right", plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) + scale_shape_manual(labels = c("Highest Indegree Senators", "Highest Outdegree Senators"), values = c(17, 18)) +  guides(shape=guide_legend(title='Most Central Senators'))
set.seed(2103)
senatorsnetwork_withcluster_df <- ggnetwork(network, layout = "kamadakawai", cell.jitter = 0.75)
ggplot(senatorsnetwork_withcluster_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.3) + geom_nodetext_repel(aes(label = vertex.names, color=Clusteridentification), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators with Cluster Identification') + theme_tufte() + theme(legend.position = "right", plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_color_manual(breaks=c("Democratic Party","Independent","Republican Party"), values = c("firebrick", "royalblue", "royalblue", "seagreen", "firebrick"))
set.seed(2106)
senatorsnetwork_withcluster_df <- ggnetwork(network, layout = "kamadakawai", cell.jitter = 0.75)
ggplot(senatorsnetwork_withcluster_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.3) + geom_nodetext_repel(aes(label = vertex.names, color=Clusteridentification), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators with Cluster Identification') + theme_tufte() + theme(legend.position = "right", plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_color_manual(breaks=c("Democratic Party","Independent","Republican Party"), values = c("firebrick", "royalblue", "royalblue", "seagreen", "firebrick"))
set.seed(2103)
mentions_network_df <- ggnetwork(mentions_network, layout = "kamadakawai", cell.jitter = 0.75)
mentions_network_df <- mentions_network_df[!is.na(mentions_network_df$weight),]
ggplot(mentions_network_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.03, size=log(mentions_network_df$weight), arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.3) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Mentions Network of Senators') + theme_tufte() + theme(legend.position = "right", plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) +  guides(shape=guide_legend(title='Most Central Senators'))
set.seed(2106)
mentions_network_df <- ggnetwork(mentions_network, layout = "kamadakawai", cell.jitter = 0.75)
mentions_network_df <- mentions_network_df[!is.na(mentions_network_df$weight),]
ggplot(mentions_network_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.03, size=log(mentions_network_df$weight), arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.3) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Mentions Network of Senators') + theme_tufte() + theme(legend.position = "right", plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) +  guides(shape=guide_legend(title='Most Central Senators'))
set.seed(2105)
mentions_network_df <- ggnetwork(mentions_network, layout = "kamadakawai", cell.jitter = 0.75)
mentions_network_df <- mentions_network_df[!is.na(mentions_network_df$weight),]
ggplot(mentions_network_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.03, size=log(mentions_network_df$weight), arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.3) + geom_nodetext_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Mentions Network of Senators') + theme_tufte() + theme(legend.position = "right", plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) +  guides(shape=guide_legend(title='Most Central Senators'))
ggplot(senatorsnetwork_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.3) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3outdegree$source), aes(shape='17'), size=2) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3indegree$target), aes(shape='18'), size=2.5) + geom_nodelabel_repel(aes(label = vertex.names), size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators') + theme_tufte() + theme(legend.position = "right", plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) + scale_shape_manual(labels = c("Highest Indegree Senators", "Highest Outdegree Senators"), values = c(17, 18)) +  guides(shape=guide_legend(title='Most Central Senators'))
ggplot(senatorsnetwork_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.3) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3outdegree$source), aes(shape='17'), size=2) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3indegree$target), aes(shape='18'), size=2.5) + geom_nodelabel_repel(aes(label = vertex.names), label.padding=0.01, size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators') + theme_tufte() + theme(legend.position = "right", plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) + scale_shape_manual(labels = c("Highest Indegree Senators", "Highest Outdegree Senators"), values = c(17, 18)) +  guides(shape=guide_legend(title='Most Central Senators'))
ggplot(senatorsnetwork_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.3) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3outdegree$source), aes(shape='17'), size=2) + geom_nodes(data=subset(senatorsnetwork_df, vertex.names %in% top3indegree$target), aes(shape='18'), size=2.5) + geom_nodelabel_repel(aes(label = vertex.names), label.padding=0.05, size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators') + theme_tufte() + theme(legend.position = "right", plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_colour_manual(values = c("royalblue", "seagreen", "firebrick")) + scale_shape_manual(labels = c("Highest Indegree Senators", "Highest Outdegree Senators"), values = c(17, 18)) +  guides(shape=guide_legend(title='Most Central Senators'))
ggplot(senatorsnetwork_withcluster_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.3) + geom_nodelabel_repel(aes(label = vertex.names, color=Clusteridentification), label.padding=0.05, size = 2.5, size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators with Cluster Identification') + theme_tufte() + theme(legend.position = "right", plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_color_manual(breaks=c("Democratic Party","Independent","Republican Party"), values = c("firebrick", "royalblue", "royalblue", "seagreen", "firebrick")) + guides(color=guide_legend(title='Party \n(Node Colour = Actual \n Text Colour = Algorithm Identified)'))
ggplot(senatorsnetwork_withcluster_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.3) + geom_nodelabel_repel(aes(label = vertex.names, color=Clusteridentification), label.padding=0.05, size = 2.5, size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators with Cluster Identification') + theme_tufte() + theme(legend.position = "right", plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_color_manual(breaks=c("Democratic Party","Independent","Republican Party"), values = c("firebrick", "royalblue", "royalblue", "seagreen", "firebrick")) + guides(color=guide_legend(title='Party \n(Node = Actual \n Text = Estimated)'))
ggplot(senatorsnetwork_withcluster_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.3) + geom_nodelabel_repel(aes(label = vertex.names, color=Clusteridentification), label.padding=0.05, size = 2.5, size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators with Cluster Identification') + theme_tufte() + theme(legend.position = "right", plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_color_manual(breaks=c("Democratic Party","Independent","Republican Party"), values = c("firebrick", "royalblue", "royalblue", "seagreen", "firebrick"))
ggplot(senatorsnetwork_withcluster_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.3) + geom_nodelabel_repel(aes(label = vertex.names, color=Clusteridentification), label.padding=0.05, size = 2.5, fontface='bold', family="Garamond") + ggtitle('Twitter Network of Senators with Cluster Identification') + theme_tufte() + theme(legend.position = "right", plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_color_manual(breaks=c("Democratic Party","Independent","Republican Party"), values = c("firebrick", "royalblue", "royalblue", "seagreen", "firebrick")) + guides(color=guide_legend(title='Party \n(Node = Actual \n Text = Estimated)'))
ggplot(senatorsnetwork_withcluster_df, aes(x, y, xend = xend, yend = yend)) + geom_edges(alpha = 0.1, size=0.1, arrow = arrow(length = unit(0.3, "lines"), type = "closed")) + geom_nodes(aes(color=Party, size=Indegree), alpha=0.3) + geom_nodelabel_repel(aes(label = vertex.names, color=Clusteridentification), label.padding=0.05, size = 2.5, fontface='bold', family="Garamond", show.legend = FALSE) + ggtitle('Twitter Network of Senators with Cluster Identification') + theme_tufte() + theme(legend.position = "right", plot.title = element_text(hjust = 0.5, face='bold', size=14), text=element_text(family="Garamond"), axis.ticks = element_blank(), axis.text = element_blank(), axis.title = element_blank()) + scale_color_manual(breaks=c("Democratic Party","Independent","Republican Party"), values = c("firebrick", "royalblue", "royalblue", "seagreen", "firebrick")) + guides(color=guide_legend(title='Party \n(Node = Actual \n Text = Estimated)'))
warnings()
warnings(Untitled.html)
install.packages("rtweet")
require(rtweet)
lookup_users("BenSasse")
usethis::edit_r_environ()
system("/Users/admin/.Renviron")
